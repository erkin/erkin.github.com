<!DOCTYPE html>
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8"/>
    <meta name="title"
          content="Static HTML rainbow parens in Racket"/>
    <meta name="author"
          content="Erkin B Altunbas"/>
    <link rel="canonical"
          href="https://erkin.party/syntax/"/>

    <link href="/images/favicons/favicon-32x32.png"
          rel="icon" type="image/png" sizes="32x32"/>
    <link href="/images/favicons/favicon.ico"
          rel="shortcut icon"/>

    <title>Static HTML rainbow parens in Racket</title>
    <link rel="stylesheet" type="text/css" href="syntax.css"/>
  </head>
  <body>
    <p>
      <code>&lt;span&gt;</code> tag generator for rainbow parens.
      <br/>
      <a href="syntax.rkt" type="text/x-script.racket">Plaintext</a>
      &middot;
      <a href="syntax.css" type="text/css">CSS</a>
    </p>
    <hr/>
<code>#lang racket/base
<span class="paren-0">(</span>require racket/format
         racket/string<span class="paren-0">)</span>
<span class="paren-0">(</span>require syntax-color/racket-lexer<span class="paren-0">)</span>

<span class="paren-0">(</span>define <span class="paren-1">(</span>lexinate results depth<span class="paren-1">)</span>
  <span class="paren-1">(</span>define <span class="paren-2">(</span>make-span depth str<span class="paren-2">)</span>
    <span class="paren-2">(</span>format "&lt;span class=\"paren-~a\"&gt;~a&lt;/span&gt;" depth str<span class="paren-2">)</span><span class="paren-1">)</span>
  <span class="paren-1">(</span>define-values <span class="paren-2">(</span>str type paren start end<span class="paren-2">)</span> <span class="paren-2">(</span>racket-lexer <span class="paren-3">(</span>current-input-port<span class="paren-3">)</span><span class="paren-2">)</span><span class="paren-1">)</span>
  <span class="paren-1">(</span>if <span class="paren-2">(</span>eof-object? str<span class="paren-2">)</span>
      <span class="paren-2">(</span>string-join <span class="paren-3">(</span>reverse results<span class="paren-3">)</span> ""<span class="paren-2">)</span>
      <span class="paren-2">(</span>case paren
        <span class="paren-3">(</span><span class="paren-4">(</span>\( \[ \{<span class="paren-4">)</span>
         <span class="paren-4">(</span>lexinate <span class="paren-5">(</span>cons <span class="paren-6">(</span>make-span depth str<span class="paren-6">)</span> results<span class="paren-5">)</span> <span class="paren-5">(</span>add1 depth<span class="paren-5">)</span><span class="paren-4">)</span><span class="paren-3">)</span>
        <span class="paren-3">(</span><span class="paren-4">(</span>\) \] \}<span class="paren-4">)</span>
         <span class="paren-4">(</span>lexinate <span class="paren-5">(</span>cons <span class="paren-6">(</span>make-span <span class="paren-7">(</span>sub1 depth<span class="paren-7">)</span> str<span class="paren-6">)</span> results<span class="paren-5">)</span> <span class="paren-5">(</span>sub1 depth<span class="paren-5">)</span><span class="paren-4">)</span><span class="paren-3">)</span>
        <span class="paren-3">(</span>else
         <span class="paren-4">(</span>lexinate <span class="paren-5">(</span>cons str results<span class="paren-5">)</span> depth<span class="paren-4">)</span><span class="paren-3">)</span><span class="paren-2">)</span><span class="paren-1">)</span><span class="paren-0">)</span>

<span class="paren-0">(</span>module+ main
  <span class="paren-1">(</span>display "&lt;code&gt;"<span class="paren-1">)</span>
  <span class="paren-1">(</span>displayln <span class="paren-2">(</span>lexinate '<span class="paren-3">(</span><span class="paren-3">)</span> 0<span class="paren-2">)</span><span class="paren-1">)</span>
  <span class="paren-1">(</span>displayln "&lt;/code&gt;"<span class="paren-1">)</span><span class="paren-0">)</span>
</code>
</body>
</html>
